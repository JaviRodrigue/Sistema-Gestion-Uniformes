<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dtos="clr-namespace:VentasApp.Desktop.ViewModels.DTOs"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <DataTemplate x:Key="VentaCardTemplate"
                  DataType="{x:Type dtos:VentaCardDto}">

        <!-- Forzar estiramiento horizontal de la tarjeta -->
        <Border CornerRadius="12"
                Margin="0,0,0,0"
                Padding="8"
                Background="{StaticResource CardBackground}"
                HorizontalAlignment="Stretch">

            <Border.Effect>
                <DropShadowEffect BlurRadius="6" Opacity="0.18"/>
            </Border.Effect>

            <Expander BorderThickness="0" HorizontalAlignment="Stretch">

                <Expander.Header>

                    <Grid VerticalAlignment="Center" HorizontalAlignment="Stretch">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="160"/>
                            <ColumnDefinition Width="140"/>
                        </Grid.ColumnDefinitions>

                        <!-- ICON -->
                        <Border Grid.Column="0"
                                Width="50"
                                Height="50"
                                CornerRadius="30"
                                Background="{StaticResource PrimaryPastel}"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center">
                            <materialDesign:PackIcon
                                Kind="Cart"
                                Width="26"
                                Height="26"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center"/>
                        </Border>

                        <!-- INFO -->
                        <StackPanel Grid.Column="1" Margin="10,0" VerticalAlignment="Center" HorizontalAlignment="Stretch">
                            <TextBlock Text="{Binding Codigo}"
                                       FontWeight="Bold"
                                       FontSize="15"
                                       Foreground="{StaticResource TextDark}"/>

                            <TextBlock Text="{Binding Cliente}"
                                       Foreground="{StaticResource TextLight}"
                                       Margin="0,4,0,0"/>

                            <TextBlock Text="{Binding Fecha, StringFormat='Fecha: {0:dd/MM/yyyy}'}"
                                       Foreground="{StaticResource TextLight}"
                                       Margin="0,2,0,0"/>
                        </StackPanel>

                        <!-- TOTALES -->
                        <StackPanel Grid.Column="2"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center">
                            <TextBlock Text="{Binding Total, StringFormat='Total ${0:N2}'}"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource AccentBlue}"
                                       HorizontalAlignment="Right"/>
                            <TextBlock Text="{Binding Restante, StringFormat='Restante ${0:N2}'}"
                                       Foreground="Red"
                                       HorizontalAlignment="Right"
                                       Margin="0,4,0,0"/>
                        </StackPanel>

                        <!-- BOTONES -->
                        <StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                            <Button Style="{StaticResource MaterialDesignRaisedButton}"
                                    Background="{StaticResource AccentBlue}"
                                    Command="{Binding DataContext.VerDetalleCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                    CommandParameter="{Binding}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Eye" Margin="0,0,6,0" />
                                    <TextBlock Text="Detalle" Foreground="White"/>
                                </StackPanel>
                            </Button>

                            <Button Style="{StaticResource MaterialDesignRaisedButton}"
                                    Background="{StaticResource AccentRed}"
                                    Foreground="White"
                                    Command="{Binding DataContext.EliminarVentaCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                    CommandParameter="{Binding}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Delete" Margin="0,0,6,0" />
                                    <TextBlock Text="Eliminar" Foreground="White"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>

                    </Grid>

                </Expander.Header>

                <!-- RESUMEN -->
                <Border Background="#F8F8F8" Padding="10" Margin="10,8,10,0">
                    <StackPanel>
                        <TextBlock Text="{Binding EstadoVenta}" FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding EstadoPago}" Foreground="{StaticResource TextLight}" Margin="0,4,0,0"/>
                        <TextBlock Text="{Binding FechaEstimada, StringFormat='Entrega: {0:d}'}"
                                   Foreground="{StaticResource TextLight}"
                                   Margin="0,6,0,0"
                                   Visibility="{Binding FechaEstimada, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter='invert'}"/>
                    </StackPanel>
                </Border>

            </Expander>

        </Border>

    </DataTemplate>

</ResourceDictionary>