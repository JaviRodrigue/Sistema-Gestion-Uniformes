<Window x:Class="VentasApp.Desktop.Views.Ventas.DetalleVentaWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Detalle Venta"
        Height="720"
        Width="1000"
        WindowStartupLocation="CenterOwner">


    <Grid Margin="20">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="2*"/>
            <RowDefinition Height="2*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>


        <!-- HEADER -->
        <StackPanel>
            <TextBlock Text="Detalle de Venta"
                       FontSize="22"
                       FontWeight="Bold"/>

            <TextBox Margin="0,10,0,0"
                     Text="{Binding Cliente, UpdateSourceTrigger=PropertyChanged}"
                     AutomationProperties.Name="Cliente"/>
        </StackPanel>


        <!-- ================= ITEMS ================= -->
        <GroupBox Header="Productos" Grid.Row="1" Margin="0,10">

            <DockPanel>

                <Button Content="Agregar item"
                        Background="{StaticResource AccentBlue}"
                        DockPanel.Dock="Top"/>

                <DataGrid ItemsSource="{Binding Items}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Producto" Binding="{Binding Producto, Mode=TwoWay}" Width="*"/>
                        <DataGridTextColumn Header="Precio" Binding="{Binding PrecioUnitario, Mode=TwoWay}" Width="120"/>
                        <DataGridTextColumn Header="Cantidad" Binding="{Binding Cantidad, Mode=TwoWay}" Width="100"/>
                        <DataGridTextColumn Header="Subtotal" Binding="{Binding Subtotal, StringFormat=C}" IsReadOnly="True"/>

                        <DataGridTemplateColumn Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="X"
                                            Command="{Binding DataContext.EliminarItemCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding}"
                                            Background="{StaticResource AccentRed}"
                                            Foreground="White"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>

                </DataGrid>

            </DockPanel>
        </GroupBox>


        <!-- ================= PAGOS ================= -->
        <GroupBox Header="Pagos" Grid.Row="2" Margin="0,10">

            <DockPanel>

                <Button Content="Agregar pago"
                        Background="{StaticResource AccentBlue}"
                        DockPanel.Dock="Top"/>

                <DataGrid ItemsSource="{Binding Pagos}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Fecha" Binding="{Binding Fecha, Mode=TwoWay, StringFormat=d}" Width="140"/>
                        <DataGridTextColumn Header="Monto" Binding="{Binding Monto, Mode=TwoWay}" Width="120"/>
                        <DataGridTextColumn Header="Medio" Binding="{Binding MedioPago, Mode=TwoWay}" Width="*"/>

                        <DataGridTemplateColumn Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="X"
                                        Command="{Binding DataContext.EliminarPagoCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding}"
                                        Background="{StaticResource AccentRed}"
                                        Foreground="White"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                    </DataGrid.Columns>

                </DataGrid>

            </DockPanel>
        </GroupBox>


        <!-- FOOTER -->
        <StackPanel Grid.Row="3"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,10">

            <TextBlock Text="{Binding Total, StringFormat='Total: ${0:N2}'}" Margin="20,0"/>
            <TextBlock Text="{Binding Pagado, StringFormat='Pagado: ${0:N2}'}" Margin="20,0"/>
            <TextBlock Text="{Binding Restante, StringFormat='Restante: ${0:N2}'}"
                       FontWeight="Bold"
                       Foreground="Red"
                       Margin="20,0"/>

            <Button Content="Guardar" Width="100" Margin="10,0" Click="Guardar_Click"/>
        </StackPanel>

    </Grid>
</Window>