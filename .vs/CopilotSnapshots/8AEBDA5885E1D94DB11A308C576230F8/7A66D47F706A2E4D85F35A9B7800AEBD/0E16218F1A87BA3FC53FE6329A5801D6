<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dtos="clr-namespace:VentasApp.Desktop.ViewModels.DTOs"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <DataTemplate x:Key="VentaCardTemplate"
                  DataType="{x:Type dtos:VentaCardDto}">

        <!-- Compact card without dropdown. Border color indicates sale state. -->
        <Border CornerRadius="8"
                Margin="6"
                Padding="8"
                Background="{StaticResource CardBackground}"
                HorizontalAlignment="Stretch"
                MinHeight="72"
                BorderThickness="3">

            <Border.Effect>
                <DropShadowEffect BlurRadius="4" Opacity="0.12"/>
            </Border.Effect>

            <Border.Style>
                <Style TargetType="Border">
                    <Setter Property="BorderBrush" Value="Transparent"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding EstadoVenta}" Value="Completada">
                            <Setter Property="BorderBrush" Value="#4CAF50"/>
                            <Setter Property="Background" Value="#E8F5E9"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding EstadoVenta}" Value="Pendiente">
                            <Setter Property="BorderBrush" Value="{StaticResource WarningSoft}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding EstadoVenta}" Value="Confirmada">
                            <Setter Property="BorderBrush" Value="{StaticResource AccentBlue}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding EstadoVenta}" Value="Cancelada">
                            <Setter Property="BorderBrush" Value="{StaticResource AccentRed}"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>

            <Grid VerticalAlignment="Center" HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="48"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="140"/>
                    <ColumnDefinition Width="110"/>
                </Grid.ColumnDefinitions>

                <!-- ICON -->
                <Border Grid.Column="0"
                        Width="40"
                        Height="40"
                        CornerRadius="20"
                        Background="{StaticResource PrimaryPastel}"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center">
                    <materialDesign:PackIcon
                        Kind="Cart"
                        Width="20"
                        Height="20"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center"/>
                </Border>

                <!-- INFO -->
                <StackPanel Grid.Column="1" Margin="8,0" VerticalAlignment="Center" HorizontalAlignment="Stretch">
                    <TextBlock Text="{Binding Codigo}"
                               FontWeight="Bold"
                               FontSize="13"
                               Foreground="{StaticResource TextDark}"/>
                    <TextBlock Text="{Binding Cliente}"
                               Foreground="{StaticResource TextLight}"
                               FontSize="12"
                               Margin="0,2,0,0"/>
                </StackPanel>

                <!-- TOTALES -->
                <StackPanel Grid.Column="2"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Margin="0,0,10,0">
                    <TextBlock Text="{Binding Total, StringFormat='${0:N2}'}"
                               FontWeight="Bold"
                               Foreground="{StaticResource AccentBlue}"
                               HorizontalAlignment="Right"/>
                    <TextBlock Text="{Binding Restante, StringFormat='${0:N2}'}"
                               Foreground="Red"
                               HorizontalAlignment="Right"
                               FontSize="12"
                               Margin="0,4,0,0"/>
                </StackPanel>

                <!-- BOTONES -->
                <StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="4,0,0,0">
                    <Button Style="{StaticResource MaterialDesignRaisedButton}"
                            Background="{StaticResource AccentBlue}"
                            Command="{Binding DataContext.VerDetalleCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                            CommandParameter="{Binding}"
                            Width="42"
                            Height="34"
                            Padding="0">
                        <materialDesign:PackIcon Kind="Eye" 
                                                 Foreground="White" 
                                                 Width="18" 
                                                 Height="18"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"/>
                    </Button>

                    <Button Style="{StaticResource MaterialDesignRaisedButton}"
                            Background="{StaticResource AccentRed}"
                            Foreground="White"
                            Command="{Binding DataContext.EliminarVentaCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                            CommandParameter="{Binding}"
                            Width="42"
                            Height="34"
                            Padding="0"
                            Margin="8,0,0,0">
                        <materialDesign:PackIcon Kind="Delete" 
                                                 Foreground="White" 
                                                 Width="18" 
                                                 Height="18"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"/>
                    </Button>
                </StackPanel>

            </Grid>

        </Border>

    </DataTemplate>

</ResourceDictionary>